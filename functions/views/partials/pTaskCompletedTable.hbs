<div class="pTaskCompletedTable">
  <table class="table">
    <!-- Table headers if necessary -->
    <tbody>
      {{#each completedTasks}}
        <tr>
          <!-- Complete Button -->
          <td>
            <form action="/taskView/{{this._id}}/complete" method="post">
              <button type="submit" class="btnAction"><i class="fa-regular fa-square fa-lg"></i></button>
              <input type="hidden" name="taskId" value="{{this._id}}" />
            </form>
          </td>
          
          <!-- Task Name and Dropdown Button -->
          <td>
            {{this.taskName}}
          </td>
          
          <!-- Favorite Button -->
          <td>
            <form action="/taskView/{{this._id}}/favorite" method="post">
              <button type="submit" class="btnAction"><i class="fa-regular fa-star fa-lg"></i></button>
              <input type="hidden" name="taskId" value="{{this._id}}" />
            </form>
          </td>
          <td>
             <button class="btnTaskFullDetailsComleted btnAction"><i class="fa-solid fa-angle-down fa-lg"></i></button>
          </td>
        </tr>
        
        <!-- Hidden Details Row -->
        <tr class="hidden-details" style="display: none;">
          <td colspan="3">
            <!-- Task Details -->
            <p><strong>Details:</strong> {{this.taskDetails}}</p>
            <p><strong>Due Date:</strong> {{this.taskDueDate}}</p>
            <p><strong>Status:</strong> {{this.taskComplete}}</p>
            <p><strong>Favorite:</strong> {{this.taskFavorite}}</p>
            
            <!-- Edit Button -->
            <form action="/taskView/{{this._id}}/edit" method="get">
              <button type="submit" class="btnAction"><i class="fa-solid fa-pencil"></i></button>
            </form>
            
            <!-- Delete Button -->
            <form action="/taskView/{{this._id}}/delete" method="post">
              <button type="submit" class="btnAction"><i class="fa-regular fa-trash-can"></i></button>
            </form>
          </td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  event.stopPropagation();
  var dropdownButtons = document.querySelectorAll('.btnTaskFullDetailsComleted');
  dropdownButtons.forEach(function (button) {
    button.addEventListener('click', function () {
      var contentRow = this.closest('tr').nextElementSibling;
      if (contentRow.style.display === 'none') {
        gsap.to(contentRow, { duration: 1.2, ease: "power3.out", opacity: 1, y: "5px" });
        contentRow.style.display = 'table-row';
      } else {
        gsap.to(contentRow, { duration: 1.2, ease: "power3.in", opacity: 0, y: "0px" });
        contentRow.style.display = 'none';
      }
    });
  });
});
});
</script>